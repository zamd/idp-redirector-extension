"use strict";
module.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){const n=r(1),o=r(2),i=r(45),s=r(15);process.on("uncaughtException",e=>{console.error(e)});const a=n.createServer((e,t)=>(s.verbose("Starting Idp Redirector Extension - Version:","1.0.0"),o(e,t)));e.exports=((e,t,r)=>{t.x_wt&&t.x_wt.ectx&&t.x_wt.ectx.PUBLIC_WT_URL||!1||i.setValue("PUBLIC_WT_URL",n.urlHelpers.getWebtaskUrl(t)),a(e,t,r)})},function(e,t){e.exports=require("auth0-extension-express-tools@2.0.0")},function(e,t,r){(function(t){const n=r(3),o=(r(4),r(5)),i=(r(6),r(7)),s=r(8),a=r(9),c=r(10),u=r(11),l=r(69),d=r(72),f=r(74),p=r(45),h=r(15),{errorHandler:g}=r(76);e.exports=((e,r)=>{p.setProvider(e);const m=r?new c.WebtaskStorageContext(r,{force:1}):new c.FileStorageContext(n.join(t,"./data.json"),{mergeWrites:!0}),_=new o;_.use((e,t,r)=>{e.webtaskContext&&p.setProvider(c.configProvider.fromWebtaskContext(e.webtaskContext)),r()}),_.use(a.json({limit:"500kb"})),_.use(a.urlencoded({extended:!1}));const b=i({secret:s.expressJwtSecret({cache:!0,rateLimit:!0,jwksRequestsPerMinute:5,jwksUri:"https://"+p("AUTH0_DOMAIN")+"/.well-known/jwks.json"}),audience:p("EXTENSION_AUDIENCE"),issuer:"https://"+p("AUTH0_DOMAIN")+"/",algorithms:["RS256"]});return _.use("/api",b,u(m)),_.use("/meta",d()),_.use("/.extensions",l()),_.use(f(m)),_.use(g(h.verbose)),_})}).call(this,"/")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("morgan@1.9.1")},function(e,t){e.exports=require("express@4.17.1")},function(e,t){e.exports=require("querystring")},function(e,t){e.exports=require("express-jwt@5.1.0")},function(e,t){e.exports=require("jwks-rsa@1.6.0")},function(e,t){e.exports=require("body-parser@1.12.4")},function(e,t){e.exports=require("auth0-extension-tools@1.4.0")},function(e,t,r){const{Router:n}=r(5),o=r(12),{URL:i}=r(13),{middlewares:s}=r(1),a=r(14),c=r(15),u=r(45),l=r(67),d=r(68);e.exports=(e=>{const t=new n,r=async(t,r)=>{const n=await e.read();n.errorPage=t,r&&(n.hostToPattern=r);try{await e.write(n),c.debug("Allowlist and errorPage updated"),delete global.storageData}catch(e){throw e}},f=(e,t,r)=>{const n=r.error_code;return r.error_description=`[${n}] ${r.error_description}`,e.status(t).json(r)},p=async(e,t)=>{let r=null;try{const{error_page:n}=await e.auth0.getTenantSettings({});if(n&&(r=n.url),!r)return void f(t,400,{error:"no_error_page",error_code:l.api.missing_error_page,error_description:"Failed to fetch the error page from the tenant settings"})}catch(r){return c.error({req:e,type:"failed_PUT_error_page",description:`Could not call management API because: ${r.message}`,error_code:l.internal.failed_fetching_error_page}),void f(t,500,{error:"internal_error",error_code:l.internal.failed_fetching_error_page,error_description:"Internal Server Error"})}try{new i(r)}catch(e){return void f(t,400,{error:"bad_error_page",error_code:l.api.bad_error_page,error_description:`Bad error page ${r} because: ${e.message}`})}return r},h=()=>s.managementApiClient({domain:u("AUTH0_DOMAIN"),clientId:u("AUTH0_CLIENT_ID"),clientSecret:u("AUTH0_CLIENT_SECRET")}),g=o.string().min(10).max(1024),m=o.object().keys({clientName:o.string().min(1).max(200).required(),loginUrl:g.optional(),patterns:o.array().items(g.regex(/^[^*]*\*?$/).required()).min(1).required()}),_=o.array().items(m);return t.put("/errorPage",a(["update:patterns"]),h(),async(e,t)=>{try{delete e.query,delete e.body;const n=await p(e,t);if(!n)return;return await r(n),c.info({req:e,type:"redirector_successful_PUT_error_page",description:"Successful Error Page Update"}),t.status(204).send()}catch(r){return 409===r.code?f(t,409,{error:"update_conflict",error_code:l.api.update_conflict,error_description:"Can not override conflicting update, ensure you have the latest data and retry"}):(c.error({req:e,type:"failed_PUT_error_page",description:`Could not update storage because: ${r.message}`,error_code:l.internal.could_not_update_storage}),f(t,500,{error:"internal_error",error_code:l.internal.could_not_update_storage,error_description:"Internal Server Error"}))}}),t.put("/",a(["update:patterns"]),h(),async(e,t)=>{delete e.query;const n=e.body,s={};try{const{error:e}=await o.validate(n,_);if(e)return c.verbose(`Failed attempt to update allowlist: ${e.message}`),f(t,400,{error:"invalid_request",error_code:l.api.invalid_schema,error_description:e.message});n.forEach(e=>{if(e.loginUrl)try{new i(e.loginUrl)}catch(t){throw new Error(`loginUrl must be in the format of a URL: ${e.loginUrl}`)}e.patterns.forEach(t=>{const r=t.endsWith("*");let n=null;const o=r?t.substr(0,t.length-1):t;try{n=new i(o)}catch(e){throw c.debug(`Bad pattern: ${t}, ${o}`,e),new Error(`pattern must be in the format of a URL: ${t}`)}const a=`${n.protocol}//${n.host}`;if(o===a&&r)throw new Error(`pattern can not have a wildcard as part of the hostname: ${t}`);Object.prototype.hasOwnProperty.call(s,a)||(s[a]=[]);let u=s[a].find(t=>t.clientName===e.clientName);u||(u={clientName:e.clientName,patterns:[]},e.loginUrl&&(u.loginUrl=e.loginUrl.startsWith(a)?e.loginUrl.substr(a.length):e.loginUrl),s[a].push(u)),u.patterns.push(t.substr(a.length))})})}catch(e){return c.verbose(`Failed attempt to update allowlist: ${e.message}`),f(t,400,{error:"invalid_request",error_code:l.api.invalid_allowlist,error_description:e.message})}try{const o=await p(e,t);if(c.debug(`Got error page ${o}`),!o)return;return await r(o,s),e.query={},c.info({req:e,type:"redirector_successful_PUT",description:"Successful Allowlist Update"}),t.status(200).json(n)}catch(r){return 409===r.code?f(t,409,{error:"update_conflict",error_code:l.api.update_conflict,error_description:"Can not override conflicting update, ensure you have the latest data and retry"}):(c.error({req:e,type:"redirector_failed_PUT",description:`Could not update storage because: ${r.message}`,error_code:l.internal.could_not_update_storage}),f(t,500,{error:"internal_error",error_code:l.internal.could_not_update_storage,error_description:"Internal Server Error"}))}}),t.get("/",a(["read:patterns"]),(t,r)=>{c.debug("reading data"),e.read().then(e=>{const t={};(e=e||{}).hostToPattern=e.hostToPattern||{},Object.keys(e.hostToPattern).forEach(r=>{e.hostToPattern[r].forEach(e=>{let n=t[e.clientName];n||(n={clientName:e.clientName,patterns:[]},e.loginUrl&&(n.loginUrl=d(r,e.loginUrl)),t[e.clientName]=n),e.patterns.forEach(e=>n.patterns.push(d(r,e)))})}),r.json(Object.keys(t).map(e=>t[e]))})}),t})},function(e,t){e.exports=require("joi@9.0.4")},function(e,t){e.exports=require("url")},function(e,t){e.exports=((e,t)=>{if(!Array.isArray(e))throw new Error("Parameter expectedScopes must be an array of strings representing the scopes for the endpoint(s)");return(r,n,o)=>{const i=r=>{if(t&&t.failWithError)return o({statusCode:403,error:"Forbidden",message:"Insufficient scope"});r.append("WWW-Authenticate",`Bearer scope="${e.join(" ")}", error="Insufficient scope"`),r.status(403).send("Insufficient scope")};if(0===e.length)return o();let s,a=[],c="scope";if(t&&null!=t.customScopeKey&&"string"==typeof t.customScopeKey&&(c=t.customScopeKey),!r.user)return i(n);if("string"==typeof r.user[c])a=r.user[c].split(" ");else{if(!Array.isArray(r.user[c]))return i(n);a=r.user[c]}return(s=t&&t.checkAllScopes?e.every(e=>a.includes(e)):e.some(e=>a.includes(e)))?o():i(n)}})},function(e,t,r){const n=r(16),o=r(17),i=r(65),s=n.createLogger({transports:[new n.transports.Console({level:"verbose",handleExceptions:!1,format:n.format.combine(new i({includeID:!1}),n.format.printf(({date:e,level:t,stack:r,description:n,...o})=>{const i=r?`\n${r}`:"";return`[${e}] ${t}: ${n} ${o&&Object.keys(o).length?`\n${JSON.stringify(o)}`:""} ${i}`}))}),new o({level:"info",handleExceptions:!1,format:new i({includeID:!0})})],exitOnError:!1});e.exports=s,e.exports.stream={write:e=>{s.verbose(e.replace(/\n$/,""))}}},function(e,t){e.exports=require("winston@3.1.0")},function(e,t,r){const n=r(18),o=r(44),i=r(45),s=r(46).HttpsAgent;e.exports=class extends n{constructor(e){super(e)}async log(e,t){setImmediate(()=>{this.emit("logged",e)});try{global.keepaliveAgent||(global.keepaliveAgent=new s({timeout:3e4,freeSocketTimeout:1e4}));const t=o.create({httpsAgent:global.keepaliveAgent}),r=i("DATADOG_API_KEY"),n=i("DATADOG_URL")||"https://http-intake.logs.datadoghq.com/v1/input";await t.post(n,e,{headers:{"DD-API-KEY":r},timeout:1e3})}catch(e){console.error(`Failed logging to datadog because: ${e.message}, ${e.response&&JSON.stringify(e.response.data)}`)}t()}logException(){}}},function(e,t,r){"use strict";const n=r(19),o=r(20),{LEVEL:i}=r(39),s=e.exports=function(e={}){o.call(this,{objectMode:!0,highWaterMark:e.highWaterMark}),this.format=e.format,this.level=e.level,this.handleExceptions=e.handleExceptions,this.silent=e.silent,e.log&&(this.log=e.log),e.logv&&(this.logv=e.logv),e.close&&(this.close=e.close),this.once("pipe",e=>{this.levels=e.levels,this.parent=e}),this.once("unpipe",e=>{e===this.parent&&(this.parent=null,this.close&&this.close())})};n.inherits(s,o),s.prototype._write=function(e,t,r){if(this.silent||!0===e.exception&&!this.handleExceptions)return r(null);const n=this.level||this.parent&&this.parent.level;if(!n||this.levels[n]>=this.levels[e[i]]){if(e&&!this.format)return this.log(e,r);let t,n;try{n=this.format.transform(Object.assign({},e),this.format.options)}catch(e){t=e}if(t||!n){if(r(),t)throw t;return}return this.log(n,r)}return r(null)},s.prototype._writev=function(e,t){if(this.logv){const r=e.filter(this._accept,this);return r.length?this.logv(r,t):t(null)}for(let r=0;r<e.length;r++){if(!this._accept(e[r]))continue;if(e[r].chunk&&!this.format){this.log(e[r].chunk,e[r].callback);continue}let n,o;try{o=this.format.transform(Object.assign({},e[r].chunk),this.format.options)}catch(e){n=e}if(n||!o){if(e[r].callback(),n)throw t(null),n}else this.log(o,e[r].callback)}return t(null)},s.prototype._accept=function(e){const t=e.chunk;if(this.silent)return!1;const r=this.level||this.parent&&this.parent.level;return!(!0!==t.exception&&r&&!(this.levels[r]>=this.levels[t[i]])||!this.handleExceptions&&!0===t.exception)},s.prototype._nop=function(){}},function(e,t){e.exports=require("util")},function(e,t,r){var n=r(21),o=r(22);"disable"===Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"}).READABLE_STREAM?e.exports=n&&n.Writable||o:e.exports=o},function(e,t){e.exports=require("stream")},function(e,t,r){"use strict";var n=r(23);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var n=e.entry;e.entry=null;for(;n;){var o=n.callback;t.pendingcb--,o(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=m;var i,s=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:n.nextTick;m.WritableState=g;var a=Object.create(r(24));a.inherits=r(25);var c={deprecate:r(27)},u=r(28),l=r(29).Buffer,d=global.Uint8Array||function(){};var f,p=r(31);function h(){}function g(e,t){i=i||r(32),e=e||{};var a=t instanceof i;this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var c=e.highWaterMark,u=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=c||0===c?c:a&&(u||0===u)?u:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var d=!1===e.decodeStrings;this.decodeStrings=!d,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,o=r.sync,i=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,o,i){--t.pendingcb,r?(n.nextTick(i,o),n.nextTick(S,e,t),e._writableState.errorEmitted=!0,e.emit("error",o)):(i(o),e._writableState.errorEmitted=!0,e.emit("error",o),S(e,t))}(e,r,o,t,i);else{var a=y(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||E(e,r),o?s(b,e,r,a,i):b(e,r,a,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function m(e){if(i=i||r(32),!(f.call(m,this)||this instanceof i))return new m(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),u.call(this)}function _(e,t,r,n,o,i,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(o,t.onwrite):e._write(o,i,t.onwrite),t.sync=!1}function b(e,t,r,n){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),S(e,t)}function E(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var a=0,c=!0;r;)i[a]=r,r.isBuf||(c=!1),r=r.next,a+=1;i.allBuffers=c,_(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;r;){var u=r.chunk,l=r.encoding,d=r.callback;if(_(e,t,!1,t.objectMode?1:u.length,u,l,d),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function y(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function v(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),S(e,t)})}function S(e,t){var r=y(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,n.nextTick(v,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}a.inherits(m,u),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!f.call(this,e)||this===m&&(e&&e._writableState instanceof g)}})):f=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,r){var o,i=this._writableState,s=!1,a=!i.objectMode&&(o=e,l.isBuffer(o)||o instanceof d);return a&&!l.isBuffer(e)&&(e=function(e){return l.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=i.defaultEncoding),"function"!=typeof r&&(r=h),i.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),n.nextTick(t,r)}(this,r):(a||function(e,t,r,o){var i=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),n.nextTick(o,s),i=!1),i}(this,i,e,r))&&(i.pendingcb++,s=function(e,t,r,n,o,i){if(!r){var s=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=l.from(t,r));return t}(t,n,o);n!==s&&(r=!0,o="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:o,isBuf:r,callback:i,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else _(e,t,!1,a,n,o,i);return c}(this,i,a,e,t,r)),s},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||E(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,r){var o=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),o.corked&&(o.corked=1,this.uncork()),o.ending||o.finished||function(e,t,r){t.ending=!0,S(e,t),r&&(t.finished?n.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,o,r)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=p.destroy,m.prototype._undestroy=p.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}},function(e,t,r){"use strict";"undefined"==typeof process||!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?e.exports={nextTick:function(e,t,r,n){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,i,s=arguments.length;switch(s){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick(function(){e.call(null,t)});case 3:return process.nextTick(function(){e.call(null,t,r)});case 4:return process.nextTick(function(){e.call(null,t,r,n)});default:for(o=new Array(s-1),i=0;i<o.length;)o[i++]=arguments[i];return process.nextTick(function(){e.apply(null,o)})}}}:e.exports=process},function(e,t){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=Buffer.isBuffer},function(e,t,r){try{var n=r(19);if("function"!=typeof n.inherits)throw"";e.exports=n.inherits}catch(t){e.exports=r(26)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},function(e,t,r){e.exports=r(19).deprecate},function(e,t,r){e.exports=r(21)},function(e,t,r){var n=r(30),o=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return o(e,t,r)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=n:(i(n,t),t.Buffer=s),i(o,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=o(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t){e.exports=require("buffer")},function(e,t,r){"use strict";var n=r(23);function o(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,i=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return i||s?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(o,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(n.nextTick(o,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,r){"use strict";var n=r(23),o=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=d;var i=Object.create(r(24));i.inherits=r(25);var s=r(33),a=r(22);i.inherits(d,s);for(var c=o(a.prototype),u=0;u<c.length;u++){var l=c[u];d.prototype[l]||(d.prototype[l]=a.prototype[l])}function d(e){if(!(this instanceof d))return new d(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||n.nextTick(p,this)}function p(e){e.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),d.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},function(e,t,r){"use strict";var n=r(23);e.exports=b;var o,i=r(34);b.ReadableState=_;r(35).EventEmitter;var s=function(e,t){return e.listeners(t).length},a=r(28),c=r(29).Buffer,u=global.Uint8Array||function(){};var l=Object.create(r(24));l.inherits=r(25);var d=r(19),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var p,h=r(36),g=r(31);l.inherits(b,a);var m=["error","close","destroy","pause","resume"];function _(e,t){o=o||r(32),e=e||{};var n=t instanceof o;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,s=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:n&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=r(37).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function b(e){if(o=o||r(32),!(this instanceof b))return new b(e);this._readableState=new _(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function E(e,t,r,n,o){var i,s=e._readableState;null===t?(s.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,C(e)}(e,s)):(o||(i=function(e,t){var r;n=t,c.isBuffer(n)||n instanceof u||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var n;return r}(s,t)),i?e.emit("error",i):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),n?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):y(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?y(e,s,t,!1):T(e,s)):y(e,s,t,!1))):n||(s.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function y(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&C(e)),T(e,t)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=g.destroy,b.prototype._undestroy=g.undestroy,b.prototype._destroy=function(e,t){this.push(null),t(e)},b.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=c.from(e,t),t=""),r=!0),E(this,e,t,!1,r)},b.prototype.unshift=function(e){return E(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(e){return p||(p=r(37).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var v=8388608;function S(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=v?e=v:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function C(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?n.nextTick(w,e):w(e))}function w(e){f("emit readable"),e.emit("readable"),O(e)}function T(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(k,e,t))}function k(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function N(e){f("readable nexttick read 0"),e.read(0)}function x(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),O(e),t.flowing&&!t.reading&&e.read(0)}function O(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function I(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,n=1,o=r.data;e-=o.length;for(;r=r.next;){var i=r.data,s=e>i.length?i.length:e;if(s===i.length?o+=i:o+=i.slice(0,e),0===(e-=s)){s===i.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=i.slice(s));break}++n}return t.length-=n,o}(e,t):function(e,t){var r=c.allocUnsafe(e),n=t.head,o=1;n.data.copy(r),e-=n.data.length;for(;n=n.next;){var i=n.data,s=e>i.length?i.length:e;if(i.copy(r,r.length-e,0,s),0===(e-=s)){s===i.length?(++o,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(s));break}++o}return t.length-=o,r}(e,t);return n}(e,t.buffer,t.decoder),r);var r}function A(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,n.nextTick(L,t,e))}function L(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function R(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}b.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?A(this):C(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&A(this),null;var n,o=t.needReadable;return f("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",o=!0),t.ended||t.reading?f("reading or ended",o=!1):o&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(r,t))),null===(n=e>0?I(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&A(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(e,t){var r=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,f("pipe count=%d opts=%j",o.pipesCount,t);var a=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?u:b;function c(t,n){f("onunpipe"),t===r&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,f("cleanup"),e.removeListener("close",m),e.removeListener("finish",_),e.removeListener("drain",l),e.removeListener("error",g),e.removeListener("unpipe",c),r.removeListener("end",u),r.removeListener("end",b),r.removeListener("data",h),d=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function u(){f("onend"),e.end()}o.endEmitted?n.nextTick(a):r.once("end",a),e.on("unpipe",c);var l=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,O(e))}}(r);e.on("drain",l);var d=!1;var p=!1;function h(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==R(o.pipes,e))&&!d&&(f("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,p=!0),r.pause())}function g(t){f("onerror",t),b(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",_),b()}function _(){f("onfinish"),e.removeListener("close",m),b()}function b(){f("unpipe"),r.unpipe(e)}return r.on("data",h),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?i(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",m),e.once("finish",_),e.emit("pipe",r),o.flowing||(f("pipe resume"),r.resume()),e},b.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var i=0;i<o;i++)n[i].emit("unpipe",this,r);return this}var s=R(t.pipes,e);return-1===s?this:(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},b.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var o=this._readableState;o.endEmitted||o.readableListening||(o.readableListening=o.needReadable=!0,o.emittedReadable=!1,o.reading?o.length&&C(this):n.nextTick(N,this))}return r},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(x,e,t))}(this,e)),this},b.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(e){var t=this,r=this._readableState,n=!1;for(var o in e.on("end",function(){if(f("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)}),e.on("data",function(o){(f("wrapped data"),r.decoder&&(o=r.decoder.write(o)),!r.objectMode||null!==o&&void 0!==o)&&((r.objectMode||o&&o.length)&&(t.push(o)||(n=!0,e.pause())))}),e)void 0===this[o]&&"function"==typeof e[o]&&(this[o]=function(t){return function(){return e[t].apply(e,arguments)}}(o));for(var i=0;i<m.length;i++)e.on(m[i],this.emit.bind(this,m[i]));return this._read=function(t){f("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=I},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t){e.exports=require("events")},function(e,t,r){"use strict";var n=r(29).Buffer,o=r(19);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,o,i=n.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,r=i,o=a,t.copy(r,o),a+=s.data.length,s=s.next;return i},e}(),o&&o.inspect&&o.inspect.custom&&(e.exports.prototype[o.inspect.custom]=function(){var e=o.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t,r){"use strict";var n=r(38).Buffer,o=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function i(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===o||!o(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=l,this.end=d,t=3;break;default:return this.write=f,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function l(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function p(e){return e&&e.length?this.write(e):""}t.StringDecoder=i,i.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},i.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},i.prototype.text=function(e,t){var r=function(e,t,r){var n=t.length-1;if(n<r)return 0;var o=s(t[n]);if(o>=0)return o>0&&(e.lastNeed=o-1),o;if(--n<r||-2===o)return 0;if((o=s(t[n]))>=0)return o>0&&(e.lastNeed=o-2),o;if(--n<r||-2===o)return 0;if((o=s(t[n]))>=0)return o>0&&(2===o?o=0:e.lastNeed=o-3),o;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},i.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,r){var n=r(30),o=n.Buffer;function i(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return o(e,t,r)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=n:(i(n,t),t.Buffer=s),i(o,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=o(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"LEVEL",{value:Symbol.for("level")}),Object.defineProperty(t,"MESSAGE",{value:Symbol.for("message")}),Object.defineProperty(t,"SPLAT",{value:Symbol.for("splat")}),Object.defineProperty(t,"configs",{value:r(40)})},function(e,t,r){"use strict";Object.defineProperty(t,"cli",{value:r(41)}),Object.defineProperty(t,"npm",{value:r(42)}),Object.defineProperty(t,"syslog",{value:r(43)})},function(e,t,r){"use strict";t.levels={error:0,warn:1,help:2,data:3,info:4,debug:5,prompt:6,verbose:7,input:8,silly:9},t.colors={error:"red",warn:"yellow",help:"cyan",data:"grey",info:"green",debug:"blue",prompt:"grey",verbose:"cyan",input:"grey",silly:"magenta"}},function(e,t,r){"use strict";t.levels={error:0,warn:1,info:2,http:3,verbose:4,debug:5,silly:6},t.colors={error:"red",warn:"yellow",info:"green",http:"green",verbose:"cyan",debug:"blue",silly:"magenta"}},function(e,t,r){"use strict";t.levels={emerg:0,alert:1,crit:2,error:3,warning:4,notice:5,info:6,debug:7},t.colors={emerg:"red",alert:"yellow",crit:"red",error:"red",warning:"red",notice:"yellow",info:"green",debug:"blue"}},function(e,t){e.exports=require("axios@0.19.2")},function(e,t,r){e.exports=r(10).config()},function(e,t,r){"use strict";e.exports=r(47),e.exports.HttpsAgent=r(63),e.exports.constants=r(62)},function(e,t,r){"use strict";const n=r(48).Agent,o=r(49),i=r(51)("agentkeepalive"),s=r(58)("agentkeepalive"),{INIT_SOCKET:a,CURRENT_ID:c,CREATE_ID:u,SOCKET_CREATED_TIME:l,SOCKET_NAME:d,SOCKET_REQUEST_COUNT:f,SOCKET_REQUEST_FINISHED_COUNT:p}=r(62);let h=1;const g=parseInt(process.version.split(".",1)[0].substring(1));g>=11&&g<=12?h=2:g>=13&&(h=3);function m(e){return e.timeout||e._idleTimeout}function _(e){const t={};for(const r in e)t[r]=e[r].length;return t}e.exports=class extends n{constructor(e){(e=e||{}).keepAlive=!1!==e.keepAlive,void 0===e.freeSocketTimeout&&(e.freeSocketTimeout=15e3),e.keepAliveTimeout&&(s("options.keepAliveTimeout is deprecated, please use options.freeSocketTimeout instead"),e.freeSocketTimeout=e.keepAliveTimeout,delete e.keepAliveTimeout),e.freeSocketKeepAliveTimeout&&(s("options.freeSocketKeepAliveTimeout is deprecated, please use options.freeSocketTimeout instead"),e.freeSocketTimeout=e.freeSocketKeepAliveTimeout,delete e.freeSocketKeepAliveTimeout),void 0===e.timeout&&(e.timeout=Math.max(2*e.freeSocketTimeout,3e4)),e.timeout=o(e.timeout),e.freeSocketTimeout=o(e.freeSocketTimeout),e.socketActiveTTL=e.socketActiveTTL?o(e.socketActiveTTL):0,super(e),this[c]=0,this.createSocketCount=0,this.createSocketCountLastCheck=0,this.createSocketErrorCount=0,this.createSocketErrorCountLastCheck=0,this.closeSocketCount=0,this.closeSocketCountLastCheck=0,this.errorSocketCount=0,this.errorSocketCountLastCheck=0,this.requestCount=0,this.requestCountLastCheck=0,this.timeoutSocketCount=0,this.timeoutSocketCountLastCheck=0,this.on("free",e=>{const t=this.calcSocketTimeout(e);t>0&&e.timeout!==t&&e.setTimeout(t)})}get freeSocketKeepAliveTimeout(){return s("agent.freeSocketKeepAliveTimeout is deprecated, please use agent.options.freeSocketTimeout instead"),this.options.freeSocketTimeout}get timeout(){return s("agent.timeout is deprecated, please use agent.options.timeout instead"),this.options.timeout}get socketActiveTTL(){return s("agent.socketActiveTTL is deprecated, please use agent.options.socketActiveTTL instead"),this.options.socketActiveTTL}calcSocketTimeout(e){let t=this.options.freeSocketTimeout;const r=this.options.socketActiveTTL;if(r){const n=r-(Date.now()-e[l]);if(n<=0)return n;t&&n<t&&(t=n)}if(t)return e.freeSocketTimeout||e.freeSocketKeepAliveTimeout||t}keepSocketAlive(e){const t=super.keepSocketAlive(e);if(!t)return t;const r=this.calcSocketTimeout(e);return void 0===r||(r<=0?(i("%s(requests: %s, finished: %s) free but need to destroy by TTL, request count %s, diff is %s",e[d],e[f],e[p],r),!1):(e.timeout!==r&&e.setTimeout(r),!0))}reuseSocket(...e){super.reuseSocket(...e);const t=e[0];e[1].reusedSocket=!0;const r=this.options.timeout;m(t)!==r&&(t.setTimeout(r),i("%s reset timeout to %sms",t[d],r)),t[f]++,i("%s(requests: %s, finished: %s) reuse on addRequest, timeout %sms",t[d],t[f],t[p],m(t))}[u](){const e=this[c]++;return this[c]===Number.MAX_SAFE_INTEGER&&(this[c]=0),e}[a](e,t){t.timeout&&(m(e)||e.setTimeout(t.timeout)),this.options.keepAlive&&e.setNoDelay(!0),this.createSocketCount++,this.options.socketActiveTTL&&(e[l]=Date.now()),e[d]=`sock[${this[u]()}#${t._agentKey}]`.split("-----BEGIN",1)[0],e[f]=1,e[p]=0,function(e,t,r){function n(){if(!t._httpMessage&&1===t[f])return;t[p]++,e.requestCount++,i("%s(requests: %s, finished: %s) free",t[d],t[f],t[p]);const n=e.getName(r);t.writable&&e.requests[n]&&e.requests[n].length&&(t[f]++,i("%s(requests: %s, finished: %s) will be reuse on agent free event",t[d],t[f],t[p]))}function o(r){i("%s(requests: %s, finished: %s) close, isError: %s",t[d],t[f],t[p],r),e.closeSocketCount++}function s(){const n=t.listeners("timeout").length,o=m(t),s=t._httpMessage,a=s&&s.listeners("timeout").length||0;i("%s(requests: %s, finished: %s) timeout after %sms, listeners %s, defaultTimeoutListenerCount %s, hasHttpRequest %s, HttpRequest timeoutListenerCount %s",t[d],t[f],t[p],o,n,h,!!s,a),i.enabled&&i("timeout listeners: %s",t.listeners("timeout").map(e=>e.name).join(", ")),e.timeoutSocketCount++;const c=e.getName(r);if(e.freeSockets[c]&&-1!==e.freeSockets[c].indexOf(t))t.destroy(),e.removeSocket(t,r),i("%s is free, destroy quietly",t[d]);else if(0===a){const n=new Error("Socket timeout");n.code="ERR_SOCKET_TIMEOUT",n.timeout=o,t.destroy(n),e.removeSocket(t,r),i("%s destroy with timeout error",t[d])}}function a(r){const n=t.listeners("error").length;i("%s(requests: %s, finished: %s) error: %s, listenerCount: %s",t[d],t[f],t[p],r,n),e.errorSocketCount++,1===n&&(i("%s emit uncaught error event",t[d]),t.removeListener("error",a),t.emit("error",r))}i("%s create, timeout %sms",t[d],m(t)),t.on("free",n),t.on("close",o),t.on("timeout",s),t.on("error",a),t.on("agentRemove",function e(){i("%s(requests: %s, finished: %s) agentRemove",t[d],t[f],t[p]),t.removeListener("close",o),t.removeListener("error",a),t.removeListener("free",n),t.removeListener("timeout",s),t.removeListener("agentRemove",e)})}(this,e,t)}createConnection(e,t){let r=!1;const n=(n,o)=>{if(!r){if(r=!0,n)return this.createSocketErrorCount++,t(n);this[a](o,e),t(n,o)}},o=super.createConnection(e,n);o&&n(null,o)}get statusChanged(){const e=this.createSocketCount!==this.createSocketCountLastCheck||this.createSocketErrorCount!==this.createSocketErrorCountLastCheck||this.closeSocketCount!==this.closeSocketCountLastCheck||this.errorSocketCount!==this.errorSocketCountLastCheck||this.timeoutSocketCount!==this.timeoutSocketCountLastCheck||this.requestCount!==this.requestCountLastCheck;return e&&(this.createSocketCountLastCheck=this.createSocketCount,this.createSocketErrorCountLastCheck=this.createSocketErrorCount,this.closeSocketCountLastCheck=this.closeSocketCount,this.errorSocketCountLastCheck=this.errorSocketCount,this.timeoutSocketCountLastCheck=this.timeoutSocketCount,this.requestCountLastCheck=this.requestCount),e}getCurrentStatus(){return{createSocketCount:this.createSocketCount,createSocketErrorCount:this.createSocketErrorCount,closeSocketCount:this.closeSocketCount,errorSocketCount:this.errorSocketCount,timeoutSocketCount:this.timeoutSocketCount,requestCount:this.requestCount,freeSockets:_(this.freeSockets),sockets:_(this.sockets),requests:_(this.requests)}}}},function(e,t){e.exports=require("http")},function(e,t,r){"use strict";var n=r(19),o=r(50);e.exports=function(e){if("number"==typeof e)return e;var t=o(e);if(void 0===t){var r=new Error(n.format("humanize-ms(%j) result undefined",e));console.warn(r.stack)}return t}},function(e,t){var r=1e3,n=60*r,o=60*n,i=24*o,s=7*i,a=365.25*i;function c(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*o;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return c(e,t,i,"day");if(t>=o)return c(e,t,o,"hour");if(t>=n)return c(e,t,n,"minute");if(t>=r)return c(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=n)return Math.round(e/n)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(52):e.exports=r(55)},function(e,t,r){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&"%c"===e&&(o=++n)}),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"}).DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=r(53)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e,t,r){e.exports=function(e){function t(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return n.colors[Math.abs(t)%n.colors.length]}function n(e){let r;function s(...e){if(!s.enabled)return;const t=s,o=Number(new Date),i=o-(r||o);t.diff=i,t.prev=r,t.curr=o,r=o,e[0]=n.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,o)=>{if("%%"===r)return r;a++;const i=n.formatters[o];if("function"==typeof i){const n=e[a];r=i.call(t,n),e.splice(a,1),a--}return r}),n.formatArgs.call(t,e),(t.log||n.log).apply(t,e)}return s.namespace=e,s.enabled=n.enabled(e),s.useColors=n.useColors(),s.color=t(e),s.destroy=o,s.extend=i,"function"==typeof n.init&&n.init(s),n.instances.push(s),s}function o(){const e=n.instances.indexOf(this);return-1!==e&&(n.instances.splice(e,1),!0)}function i(e,t){const r=n(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){const e=[...n.names.map(s),...n.skips.map(s).map(e=>"-"+e)].join(",");return n.enable(""),e},n.enable=function(e){let t;n.save(e),n.names=[],n.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(t=0;t<o;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")));for(t=0;t<n.instances.length;t++){const e=n.instances[t];e.enabled=n.enabled(e.namespace)}},n.enabled=function(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=r(54),Object.keys(e).forEach(t=>{n[t]=e[t]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=t,n.enable(n.load()),n}},function(e,t){var r=1e3,n=60*r,o=60*n,i=24*o,s=7*i,a=365.25*i;function c(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*o;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=i)return c(e,t,i,"day");if(t>=o)return c(e,t,o,"hour");if(t>=n)return c(e,t,n,"minute");if(t>=r)return c(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=i)return Math.round(e/i)+"d";if(t>=o)return Math.round(e/o)+"h";if(t>=n)return Math.round(e/n)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){const n=r(56),o=r(19);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(o.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:o}=this;if(o){const t=this.color,o="[3"+(t<8?t:"8;5;"+t),i=`  ${o};1m${n} [0m`;r[0]=i+r[0].split("\n").join("\n"+i),r.push(o+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+r[0]},t.save=function(e){e?Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"}).DEBUG=e:delete Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"}).DEBUG},t.load=function(){return Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"}).DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{const e=r(57);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"})).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase());let n=Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"})[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e},{}),e.exports=r(53)(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).replace(/\s*\n\s*/g," ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)}},function(e,t){e.exports=require("tty")},function(e,t,r){"use strict";var n=process.argv,o=n.indexOf("--"),i=function(e){e="--"+e;var t=n.indexOf(e);return-1!==t&&(-1===o||t<o)};e.exports="FORCE_COLOR"in Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"})||!(i("no-color")||i("no-colors")||i("color=false"))&&(!!(i("color")||i("colors")||i("color=true")||i("color=always"))||!(process.stdout&&!process.stdout.isTTY)&&("win32"===process.platform||"COLORTERM"in Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"})||"dumb"!==Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"}).TERM&&!!/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"}).TERM)))},function(module,exports,__webpack_require__){var callSiteToString=__webpack_require__(59).callSiteToString,eventListenerCount=__webpack_require__(59).eventListenerCount,relative=__webpack_require__(3).relative;module.exports=depd;var basePath=process.cwd();function containsNamespace(e,t){for(var r=e.split(/[ ,]+/),n=String(t).toLowerCase(),o=0;o<r.length;o++){var i=r[o];if(i&&("*"===i||i.toLowerCase()===n))return!0}return!1}function convertDataDescriptorToAccessor(e,t,r){var n=Object.getOwnPropertyDescriptor(e,t),o=n.value;return n.get=function(){return o},n.writable&&(n.set=function(e){return o=e}),delete n.value,delete n.writable,Object.defineProperty(e,t,n),n}function createArgumentsString(e){for(var t="",r=0;r<e;r++)t+=", arg"+r;return t.substr(2)}function createStackString(e){var t=this.name+": "+this.namespace;this.message&&(t+=" deprecated "+this.message);for(var r=0;r<e.length;r++)t+="\n    at "+callSiteToString(e[r]);return t}function depd(e){if(!e)throw new TypeError("argument namespace is required");var t=callSiteLocation(getStack()[1])[0];function r(e){log.call(r,e)}return r._file=t,r._ignored=isignored(e),r._namespace=e,r._traced=istraced(e),r._warned=Object.create(null),r.function=wrapfunction,r.property=wrapproperty,r}function isignored(e){return!!process.noDeprecation||containsNamespace(Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"}).NO_DEPRECATION||"",e)}function istraced(e){return!!process.traceDeprecation||containsNamespace(Object({WARN_DB_SIZE:409600,MAX_MULTISELECT_USERS:5,MULTISELECT_DEBOUNCE_MS:250,PER_PAGE:10,NODE_ENV:"production",CLIENT_VERSION:"1.0.0"}).TRACE_DEPRECATION||"",e)}function log(e,t){var r=0!==eventListenerCount(process,"deprecation");if(r||!this._ignored){var n,o,i,s,a=0,c=!1,u=getStack(),l=this._file;for(t?(s=t,(i=callSiteLocation(u[1])).name=s.name,l=i[0]):i=s=callSiteLocation(u[a=2]);a<u.length;a++)if((o=(n=callSiteLocation(u[a]))[0])===l)c=!0;else if(o===this._file)l=this._file;else if(c)break;var d=n?s.join(":")+"__"+n.join(":"):void 0;if(!(void 0!==d&&d in this._warned)){this._warned[d]=!0;var f=e;if(f||(f=i!==s&&i.name?defaultMessage(i):defaultMessage(s)),r){var p=DeprecationError(this._namespace,f,u.slice(a));process.emit("deprecation",p)}else{var h=(process.stderr.isTTY?formatColor:formatPlain).call(this,f,n,u.slice(a));process.stderr.write(h+"\n","utf8")}}}}function callSiteLocation(e){var t=e.getFileName()||"<anonymous>",r=e.getLineNumber(),n=e.getColumnNumber();e.isEval()&&(t=e.getEvalOrigin()+", "+t);var o=[t,r,n];return o.callSite=e,o.name=e.getFunctionName(),o}function defaultMessage(e){var t=e.callSite,r=e.name;r||(r="<anonymous@"+formatLocation(e)+">");var n=t.getThis(),o=n&&t.getTypeName();return"Object"===o&&(o=void 0),"Function"===o&&(o=n.name||o),o&&t.getMethodName()?o+"."+r:r}function formatPlain(e,t,r){var n=(new Date).toUTCString()+" "+this._namespace+" deprecated "+e;if(this._traced){for(var o=0;o<r.length;o++)n+="\n    at "+callSiteToString(r[o]);return n}return t&&(n+=" at "+formatLocation(t)),n}function formatColor(e,t,r){var n="[36;1m"+this._namespace+"[22;39m [33;1mdeprecated[22;39m [0m"+e+"[39m";if(this._traced){for(var o=0;o<r.length;o++)n+="\n    [36mat "+callSiteToString(r[o])+"[39m";return n}return t&&(n+=" [36m"+formatLocation(t)+"[39m"),n}function formatLocation(e){return relative(basePath,e[0])+":"+e[1]+":"+e[2]}function getStack(){var e=Error.stackTraceLimit,t={},r=Error.prepareStackTrace;Error.prepareStackTrace=prepareObjectStackTrace,Error.stackTraceLimit=Math.max(10,e),Error.captureStackTrace(t);var n=t.stack.slice(1);return Error.prepareStackTrace=r,Error.stackTraceLimit=e,n}function prepareObjectStackTrace(e,t){return t}function wrapfunction(fn,message){if("function"!=typeof fn)throw new TypeError("argument fn must be a function");var args=createArgumentsString(fn.length),deprecate=this,stack=getStack(),site=callSiteLocation(stack[1]);site.name=fn.name;var deprecatedfn=eval("(function ("+args+') {\n"use strict"\nlog.call(deprecate, message, site)\nreturn fn.apply(this, arguments)\n})');return deprecatedfn}function wrapproperty(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("argument obj must be object");var n=Object.getOwnPropertyDescriptor(e,t);if(!n)throw new TypeError("must call property on owner object");if(!n.configurable)throw new TypeError("property must be configurable");var o=this,i=callSiteLocation(getStack()[1]);i.name=t,"value"in n&&(n=convertDataDescriptorToAccessor(e,t,r));var s=n.get,a=n.set;"function"==typeof s&&(n.get=function(){return log.call(o,r,i),s.apply(this,arguments)}),"function"==typeof a&&(n.set=function(){return log.call(o,r,i),a.apply(this,arguments)}),Object.defineProperty(e,t,n)}function DeprecationError(e,t,r){var n,o=new Error;return Object.defineProperty(o,"constructor",{value:DeprecationError}),Object.defineProperty(o,"message",{configurable:!0,enumerable:!1,value:t,writable:!0}),Object.defineProperty(o,"name",{enumerable:!1,configurable:!0,value:"DeprecationError",writable:!0}),Object.defineProperty(o,"namespace",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(o,"stack",{configurable:!0,enumerable:!1,get:function(){return void 0!==n?n:n=createStackString.call(this,r)},set:function(e){n=e}}),o}},function(e,t,r){"use strict";var n=r(35).EventEmitter;function o(e,t,r){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){var n=r();return Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}),n}})}function i(e){return e.toString()}o(e.exports,"callSiteToString",function(){var e=Error.stackTraceLimit,t={},n=Error.prepareStackTrace;Error.prepareStackTrace=function(e,t){return t},Error.stackTraceLimit=2,Error.captureStackTrace(t);var o=t.stack.slice();return Error.prepareStackTrace=n,Error.stackTraceLimit=e,o[0].toString?i:r(60)}),o(e.exports,"eventListenerCount",function(){return n.listenerCount||r(61)})},function(e,t,r){"use strict";e.exports=function(e){var t=!0,r=function(e){var t,r="";e.isNative()?r="native":e.isEval()?(t=e.getScriptNameOrSourceURL())||(r=e.getEvalOrigin()):t=e.getFileName();if(t){r+=t;var n=e.getLineNumber();if(null!=n){r+=":"+n;var o=e.getColumnNumber();o&&(r+=":"+o)}}return r||"unknown source"}(e),n=e.getFunctionName(),o=e.isConstructor(),i="";if(e.isToplevel()||o)o?i+="new "+(n||"<anonymous>"):n?i+=n:(t=!1,i+=r);else{var s=e.getMethodName(),a=(c=e.receiver).constructor&&c.constructor.name||null;n?(a&&0!==n.indexOf(a)&&(i+=a+"."),i+=n,s&&n.lastIndexOf("."+s)!==n.length-s.length-1&&(i+=" [as "+s+"]")):i+=a+"."+(s||"<anonymous>")}var c;t&&(i+=" ("+r+")");return i}},function(e,t,r){"use strict";e.exports=function(e,t){return e.listeners(t).length}},function(e,t,r){"use strict";e.exports={CURRENT_ID:Symbol("agentkeepalive#currentId"),CREATE_ID:Symbol("agentkeepalive#createId"),INIT_SOCKET:Symbol("agentkeepalive#initSocket"),CREATE_HTTPS_CONNECTION:Symbol("agentkeepalive#createHttpsConnection"),SOCKET_CREATED_TIME:Symbol("agentkeepalive#socketCreatedTime"),SOCKET_NAME:Symbol("agentkeepalive#socketName"),SOCKET_REQUEST_COUNT:Symbol("agentkeepalive#socketRequestCount"),SOCKET_REQUEST_FINISHED_COUNT:Symbol("agentkeepalive#socketRequestFinishedCount")}},function(e,t,r){"use strict";const n=r(64).Agent,o=r(47),{INIT_SOCKET:i,CREATE_HTTPS_CONNECTION:s}=r(62);class a extends o{constructor(e){super(e),this.defaultPort=443,this.protocol="https:",this.maxCachedSessions=this.options.maxCachedSessions,void 0===this.maxCachedSessions&&(this.maxCachedSessions=100),this._sessionCache={map:{},list:[]}}createConnection(e){const t=this[s](e);return this[i](t,e),t}}a.prototype[s]=n.prototype.createConnection,["getName","_getSession","_cacheSession","_evictSession"].forEach(function(e){"function"==typeof n.prototype[e]&&(a.prototype[e]=n.prototype[e])}),e.exports=a},function(e,t){e.exports=require("https")},function(e,t,r){const n=r(66),o=r(45),i=(e,t)=>{if(e[t]){const r=JSON.parse(JSON.stringify(e[t]));return r.id_token&&(r.id_token="<<redacted>>"),r}return null};e.exports=class{constructor(e){this.includeID=e.includeID}transform(e){let t=Object.assign({},e);if("string"!=typeof t.message&&(t.message=Object.assign({},e.message)),t.date=(new Date).toISOString(),t.message.req){t.hostname=o("PUBLIC_WT_URL"),t.client_id=o("AUTH0_CLIENT_ID"),t.message.req.headers&&(t.message.req.headers["x-forwarded-for"]&&(t.ip=t.message.req.headers["x-forwarded-for"]),t.message.req.headers["user-agent"]&&(t.user_agent=t.message.req.headers["user-agent"])),!t.ip&&t.message.req.connection&&t.message.req.connection.remoteAddress&&(t.ip=t.message.req.connection.remoteAddress);const e=i(t.message.req,"query"),r=i(t.message.req,"body");(e||r)&&(t.details=JSON.parse(JSON.stringify(t.message.details||{})),t.details.request={},e&&(t.details.request.query=e),r&&(t.details.request.body=r)),t.message.req.user&&t.message.req.user.sub&&(t.user_id=t.message.req.user.sub),t.message.req.user_error&&(t.user_error=t.message.req.user_error),delete t.message.req}return this.includeID&&(t._id=n.v4(),t.log_id=t._id),"string"==typeof t.message?t.description=t.message:t={...t,...t.message},delete t.message,t}}},function(e,t){e.exports=require("uuid@8.0.0")},function(e,t){e.exports={api:{update_conflict:"AE001",invalid_schema:"AE002",invalid_allowlist:"AE003",bad_error_page:"AE004",missing_error_page:"AE005"},internal:{error_page_not_configured:"IE001",could_not_update_storage:"IE002",failed_fetching_error_page:"IE003"},redirect:{missing_state:"RE001",state_invalid_host:"RE002",state_did_not_match_pattern:"RE003",state_must_be_url:"RE004",bad_id_token:"RE005",forwarding_errors:"RE006"}}},function(e,t,r){const{URL:n}=r(13);e.exports=((e,t)=>{try{return new n(t),t}catch(r){return e+t}})},function(e,t,r){const{Router:n}=r(5),{middlewares:o}=r(1),i=r(45),s=r(15),a=r(70),c=r(71),u={DENY_ACCESS_RULE_NAME:"DO-NOT-MODIFY Deny User Access for Redirector API and Non SAML Login Access for Extension Client",EXTENSION_CLIENT_NAME:c.name};(e.exports=(()=>{const e=o.validateHookToken(i("AUTH0_DOMAIN"),i("WT_URL"),i("EXTENSION_SECRET")),t=n();async function r(e){const t=e.auth0.getClientGrants({audience:i("EXTENSION_AUDIENCE")}),r=e.auth0.getRules({fields:"name,id"}),[n,o]=await Promise.all([t,r]),a=o.find(e=>e.name===u.DENY_ACCESS_RULE_NAME),[c]=n,l=a?e.auth0.deleteRule({id:a.id}):Promise.resolve(),d=e.auth0.deleteClient({client_id:i("AUTH0_CLIENT_ID")}),f=c&&c.client_id?e.auth0.deleteClient({client_id:c.client_id}):Promise.resolve(),p=e.auth0.deleteResourceServer({id:encodeURIComponent(i("EXTENSION_AUDIENCE"))});await Promise.all([d,f,p,l]),s.debug(`Deleted Extension Client: ${i("AUTH0_CLIENT_ID")}`),c&&s.debug(`Deleted Deployment Client: ${c.client_id}`),s.debug(`Deleted API: ${i("EXTENSION_AUDIENCE")}`),a&&s.debug(`Deleted Rule: ${a.name}`)}return t.use(o.managementApiClient({domain:i("AUTH0_DOMAIN"),clientId:i("AUTH0_CLIENT_ID"),clientSecret:i("AUTH0_CLIENT_SECRET")})),t.use("/on-uninstall",e("/.extensions/on-uninstall")),t.delete("/on-uninstall",async(e,t)=>{s.debug(`Uninstall running version ${c.version} ...`);try{await r(e)}catch(e){s.debug(`Error deleting extension resources: ${e.message?e.message:""}`),s.verbose(e)}finally{t.sendStatus(204)}}),t.use("/on-install",e("/.extensions/on-install")),t.post("/on-install",async(e,t)=>{s.verbose(`Install running version ${c.version} ...`);const n=[{value:"update:patterns",description:"Update the allowlist patterns"},{value:"read:patterns",description:"Read the allowlist patterns"}],o=e.auth0.createResourceServer({identifier:i("EXTENSION_AUDIENCE"),name:"idp-redirector-api",scopes:n}),l=e.auth0.createClient({name:i("DEPLOYMENT_CLIENT_NAME"),app_type:"non_interactive",grant_types:["client_credentials"]}),d=e.auth0.updateClient({client_id:i("AUTH0_CLIENT_ID")},{app_type:"regular_web",grant_types:["implicit","client_credentials"],callbacks:[i("PUBLIC_WT_URL")],jwt_configuration:{lifetime_in_seconds:30,alg:"HS256"}}),f=e.auth0.createRule({enabled:!0,script:a.replace("##IDP_REDIRECTOR_AUDIENCE##",i("EXTENSION_AUDIENCE")).replace("##EXTENSION_CLIENT_NAME##",u.EXTENSION_CLIENT_NAME),name:u.DENY_ACCESS_RULE_NAME});try{const[a,c,,u]=await Promise.all([l,o,d,f]),p=await e.auth0.createClientGrant({client_id:a.client_id,audience:i("EXTENSION_AUDIENCE"),scope:n.map(e=>e.value)});return s.verbose(`Created Client: ${a.client_id}`),s.verbose(`Created API: ${c.identifier}`),s.verbose(`Created Grant: ${p.id}`),s.verbose(`Created Rule: ${u.name}`),t.sendStatus(204)}catch(n){s.debug(`Error creating extension resources: ${n.message?n.message:""}`);try{r(e)}catch(e){}return t.status(500).json({error:"failed_install",error_description:"Could not create required extension resources"})}}),t})).extensionConfig=u},function(e,t){e.exports='\nfunction denyAudienceForUserFlows_ClientAccessForNonSamlProtocol(user, context, callback) {\n  const IDP_REDIRECTOR_AUDIENCE = "##IDP_REDIRECTOR_AUDIENCE##";\n  const IDP_REDIRECTOR_CLIENT_NAME = "##EXTENSION_CLIENT_NAME##";\n\n  const requestedAudience =\n    (context.request.body && context.request.body.audience) ||\n    (context.request.query && context.request.query.audience);\n  const { clientName: requestingClient, protocol: requestedProtocol } = context;\n\n  if (requestedAudience === IDP_REDIRECTOR_AUDIENCE) {\n    return callback(\n      new UnauthorizedError(\n        `${IDP_REDIRECTOR_AUDIENCE} is not allowed for user oriented operations`\n      )\n    );\n  }\n\n  //lock down extension access to only saml protocol \n  if (requestingClient === IDP_REDIRECTOR_CLIENT_NAME && requestedProtocol !== "samlp") {\n    return callback(\n      new UnauthorizedError(\n        `The ${IDP_REDIRECTOR_CLIENT_NAME} is only authorized for SAML logins.`\n      ));\n  }\n\n  callback(null, user, context);\n}'},function(e){e.exports={title:"IdP Redirector Extension",name:"idp-redirector",version:"1.0.0",author:"auth0",useHashName:!1,description:"This extension implements safe, wildcard based redirection for SAML IdP initiated logins based on URLs from RelayState. The extension is setup as a target OIDC app for SAML IdP initiated connection.",type:"application",category:"end_user",logoUrl:"https://res-1.cloudinary.com/crunchbase-production/image/upload/c_lpad,h_120,w_120,f_auto,b_white,q_auto:eco/v1397191966/68aa3a98f81f5e09a3afb00a73461434.png",initialUrlPath:"/",docsUrl:"https://auth0.com/docs",repository:"https://github.com/zamd/idp-redirector-extension",keywords:["auth0","extension"],auth0:{createClient:!0,onUninstallPath:"/.extensions/on-uninstall",onInstallPath:"/.extensions/on-install",scopes:"create:clients read:clients update:clients delete:clients create:resource_servers read:resource_servers update:resource_servers delete:resource_servers read:connections create:client_grants read:client_grants create:rules read:rules delete:rules read:tenant_settings"},secrets:{EXTENSION_AUDIENCE:{description:"The audience for the extension API",default:"urn:idp-redirector-api"},DEPLOYMENT_CLIENT_NAME:{description:"The name of the CI/CD client",default:"IDP Redirector CI/CD Client"},DATADOG_API_KEY:{description:"API key for DataDog",required:!0,type:"password"},DATADOG_URL:{description:"The datadog URL for sending the logs",example:"https://http-intake.logs.datadoghq.com/v1/input"}}}},function(e,t,r){const n=r(5),o=r(71),i=r(44),s=r(73),a=r(15);e.exports=(()=>{const e=new n.Router;return e.get("/",async(e,t)=>{const{repository:r}=o,n=r.replace("github.com","api.github.com/repos").concat("/releases/latest").trim();try{const e=await i.get(n),{tag_name:t}=e.data;o.version=s.parse(t).version.toString()}catch(e){a.verbose("Failed to get release info from github",e)}t.status(200).send(o)}),e})},function(e,t){e.exports=require("semver@4.3.4")},function(e,t,r){const n=r(75),{Router:o}=r(5),{URL:i}=r(13),s=r(6),a=r(15),c=r(45),u=r(67),l=r(68);e.exports=(e=>{const t=new o;t.use(async(t,r,n)=>{let o=global.storageData;o&&o.hostToPattern&&o.errorPage||(a.verbose("Fetching storage data from webtask storage"),o=await e.read(),global.storageData=o),t.hostToPattern=o.hostToPattern||{},t.errorPage=o.errorPage,n()});const r=(e,t,r)=>{let n=r.code;n&&(r.error_description=`[${n}] ${r.error_description}`,delete r.code);const o={client_id:"",connection:"",lang:e.headers["accept-language"],...r};if(a.error({type:"redirector_failed_redirect",description:"Failed to redirect after IdP Initiated Login",error_code:n,details:{response:{query:o}},req:e}),!e.errorPage)return a.error({type:"redirector_internal_error",error_code:u.internal.error_page_not_configured,description:"Error page has not been configured",req:e}),t.status(500).send(JSON.stringify({error:"internal_error",error_description:`[${u.internal.error_page_not_configured}] Internal Server Error`},null,2));const c=new i(e.errorPage);return c.search=s.stringify(o),t.redirect(c.href)};return t.post("/",async(e,t,r)=>{try{if(!e.body||!e.body.id_token)throw new Error("id_token missing.");const t=e.body.id_token;e.user=await n.verify(t,c("AUTH0_CLIENT_SECRET"),{audience:c("AUTH0_CLIENT_ID"),issuer:`https://${c("AUTH0_DOMAIN")}/`})}catch(t){a.verbose(`Error attempting to decode ID token: ${t.message}`),e.user_error=u.redirect.bad_id_token}r()},(e,t)=>{e.body=e.body||{};const n=e.body.state;if(!n)return r(e,t,{code:u.redirect.missing_state,error:"invalid_request",error_description:"Missing state parameter"});let o=n,s=!1;try{const a=new i(n),c=`${a.protocol}//${a.host}`,d=e.hostToPattern[c];if(!d)return r(e,t,{code:u.redirect.state_invalid_host,error:"invalid_request",error_description:`Invalid host in state url: ${n}`});if(d.forEach(e=>{s||e.patterns.forEach(t=>{if(s)return;const r=t.endsWith("*"),o=r?t.substr(0,t.length-1):t,i=l(c,o);(r&&n.startsWith(i)||n===i)&&(s={domain:c,clientName:e.clientName,pattern:i+(r?"*":"")},e.loginUrl&&(s.loginUrl=l(c,e.loginUrl)))})}),!s)return r(e,t,{code:u.redirect.state_did_not_match_pattern,error:"invalid_request",error_description:`state must match a valid allowlist pattern: ${n}`});o=s.loginUrl?s.loginUrl:n}catch(o){return r(e,t,{code:u.redirect.state_must_be_url,error:"invalid_request",error_description:`state must be in the form of a URL: ${n}`})}let d={};e.body.error||e.body.error_description?d={error:e.body.error,error_description:e.body.error_description}:e.user_error&&(d={error:"invalid_request",error_description:`[${e.user_error}] Invalid User Token`});const f=new i(o),p={iss:`https://${c("AUTH0_DOMAIN")}`,target_link_uri:n,...d};for(const[e,t]of Object.entries(p))f.searchParams.append(e,t);const h={matched:s,response:{location:o,query:p}};return d.error&&!e.user_error?a.error({type:"redirector_forward_error",description:"Error Redirect",error_code:u.redirect.forwarding_errors,req:e,details:h}):e.user_error?a.error({type:"redirector_id_token_validation_error",description:"Error Redirect",error_code:u.redirect.bad_id_token,req:e,details:h}):a.info({type:"redirector_successful_redirect",description:"Successful Redirect",req:e,details:h}),t.redirect(f.href)}),t})},function(e,t){e.exports=require("jsonwebtoken@8.5.0")},function(e,t,r){e.exports={errorHandler:r(77)}},function(e,t,r){e.exports=(e=>(t,r,n,o)=>(e&&e(t),t&&(t.status||t.statusCode)?(n.status(t.status||t.statusCode),n.json({error:t.code||t.name,message:t.message||t.name})):(n.status(500),n.json({error:"InternalServerError",message:t.message||t.name}))))}]);